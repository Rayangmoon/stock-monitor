# 股票监控助手

一个用于 VSCode 的 A 股实时监控插件，支持最高涨幅回落提醒功能。

## 功能特性

- ✅ 实时监控 A 股行情（支持新浪、雪球数据源）
- ✅ 基于开盘价计算最高涨幅
- ✅ 自动检测回落幅度并提醒
- ✅ 状态栏实时显示监控信息
- ✅ 可配置刷新间隔和提醒阈值
- ✅ 支持多只股票同时监控

## 安装

1. 克隆或下载本项目
2. 在项目目录下执行：
```bash
npm install
npm run compile
```
3. 按 F5 在调试模式下运行插件

## 使用说明

### 添加监控股票

1. 按 `Ctrl+Shift+P`（Mac: `Cmd+Shift+P`）打开命令面板
2. 输入 `添加监控股票`
3. 依次输入：
   - 股票代码（6位数字，如：600000）
   - 股票名称（如：浦发银行）
   - 回落提醒阈值（如：2，表示从最高点回落2%时提醒）

### 查看监控列表

1. 点击状态栏左侧的 `$(eye) 股票监控` 图标
2. 或执行命令 `查看监控列表`

### 移除监控股票

1. 执行命令 `移除监控股票`
2. 从列表中选择要移除的股票

### 启动/停止监控

执行命令 `启动/停止监控` 来切换监控状态

## 配置项

在 VSCode 设置中可配置以下选项：

```json
{
  // 刷新间隔（毫秒）
  "stockMonitor.refreshInterval": 3000,

  // 默认回落提醒阈值（%）
  "stockMonitor.fallbackThreshold": 2,

  // 行情数据源（sina 或 xueqiu）
  "stockMonitor.apiSource": "sina"
}
```

## 工作原理

### 最高涨幅计算

插件会记录股票的开盘价，并持续跟踪当前价格相对于开盘价的涨幅：

```
最高涨幅 = (最高价 - 开盘价) / 开盘价 × 100%
当前涨幅 = (当前价 - 开盘价) / 开盘价 × 100%
```

### 回落提醒

当股票价格从最高点回落超过设定阈值时，插件会发送提醒：

```
回落幅度 = 最高涨幅 - 当前涨幅
```

例如：
- 开盘价：10.00 元
- 最高价：10.50 元（最高涨幅 5%）
- 当前价：10.20 元（当前涨幅 2%）
- 回落幅度：5% - 2% = 3%

如果设置的回落阈值为 2%，则会触发提醒。

### 防止频繁提醒

同一只股票在 5 分钟内只会提醒一次，避免频繁打扰。

## 状态栏说明

状态栏显示格式：`$(eye) 股票监控 (数量) 🔴+2.50% 🟢-1.20%`

- 🔴 表示上涨
- 🟢 表示下跌
- 数字表示当前涨跌幅

点击状态栏可查看详细监控列表。

## 命令列表

| 命令 | 说明 |
|------|------|
| `添加监控股票` | 添加新的监控股票 |
| `移除监控股票` | 从监控列表中移除股票 |
| `查看监控列表` | 查看所有监控中的股票 |
| `启动/停止监控` | 切换监控状态 |

## 数据源说明

### 新浪财经（默认）

- 优点：稳定、免费、无需认证
- 缺点：数据更新可能有延迟

### 雪球

- 优点：数据较新
- 缺点：需要 Cookie 认证，可能被限流

## 注意事项

1. 本插件仅供学习和个人使用
2. 股票数据来自第三方接口，不保证实时性和准确性
3. 请勿用于商业用途
4. 投资有风险，决策需谨慎

## 开发

### 项目结构

```
stock/
├── src/
│   ├── api/
│   │   └── stockApi.ts      # 股票数据 API
│   ├── monitor/
│   │   └── stockMonitor.ts  # 监控核心逻辑
│   ├── utils/
│   │   └── statusBar.ts     # 状态栏管理
│   ├── types.ts             # 类型定义
│   └── extension.ts         # 插件入口
├── package.json
├── tsconfig.json
└── README.md
```

### 编译

```bash
npm run compile
```

### 监听模式

```bash
npm run watch
```

### 打包

```bash
npm run vscode:prepublish
```

## 许可证

MIT

## 更新日志

### 0.0.1

- 初始版本
- 支持新浪、雪球数据源
- 实现最高涨幅回落提醒
- 状态栏实时显示
